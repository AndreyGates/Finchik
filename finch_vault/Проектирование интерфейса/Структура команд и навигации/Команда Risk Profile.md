**–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã `/risk_profile` –¥–ª—è Telegram-–±–æ—Ç–∞ ¬´–§–∏–Ω—á–∏–∫¬ª**

## **üìå Flowchart –∫–æ–º–∞–Ω–¥—ã `/risk_profile`**

1. **Start** ‚Üí **/risk_profile –∫–æ–º–∞–Ω–¥–∞ –ø–æ–ª—É—á–µ–Ω–∞**
2. **–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –æ–±—ä—è—Å–Ω–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—è**
3. **–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ –æ—Ü–µ–Ω–∫–µ —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—è** (–ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ, —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ—Ç–≤–µ—Ç–æ–≤):
    - –í–æ–ø—Ä–æ—Å 1: "–ö–∞–∫ —Ç—ã –æ—Ç–Ω–æ—Å–∏—à—å—Å—è –∫ —É–±—ã—Ç–∫–∞–º?"
    - –í–æ–ø—Ä–æ—Å 2: "–ö–∞–∫–æ–π —É —Ç–µ–±—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –≥–æ—Ä–∏–∑–æ–Ω—Ç?"
    - –í–æ–ø—Ä–æ—Å 3: "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –≤–∞–∂–Ω–µ–µ: —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏–ª–∏ –≤—ã—Å–æ–∫–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å?"
    - –í–æ–ø—Ä–æ—Å 4: "–ö–∞–∫—É—é –ø—Ä–æ—Å–∞–¥–∫—É –ø–æ—Ä—Ç—Ñ–µ–ª—è —Ç—ã –≥–æ—Ç–æ–≤ —Ç–µ—Ä–ø–µ—Ç—å?"
4. **–û–∂–∏–¥–∞—Ç—å –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –∫–∞–∂–¥—ã–π –≤–æ–ø—Ä–æ—Å**
5. **–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ–±—â–∏–π —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–æ–≤** (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π, —É–º–µ—Ä–µ–Ω–Ω—ã–π, –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π)
6. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**
7. **–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è–º**
8. **End**

---

## **üìå –ü–æ–ª–Ω—ã–π –∫–æ–¥ –∫–æ–º–∞–Ω–¥—ã `/risk_profile

```python
from telegram import Update
from telegram.ext import CallbackContext
from typing import Dict

# –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
user_responses: Dict[int, Dict[str, int]] = {}

# –í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—è
risk_questions = [
    "–ö–∞–∫ —Ç—ã –æ—Ç–Ω–æ—Å–∏—à—å—Å—è –∫ —É–±—ã—Ç–∫–∞–º?\n"
    "1. –ù–µ –≥–æ—Ç–æ–≤ —Ç–µ—Ä—è—Ç—å –≤–æ–æ–±—â–µ (1 –±–∞–ª–ª)\n"
    "2. –ì–æ—Ç–æ–≤ –∫ –Ω–µ–±–æ–ª—å—à–∏–º –ø—Ä–æ—Å–∞–¥–∫–∞–º (2 –±–∞–ª–ª–∞)\n"
    "3. –ì–æ—Ç–æ–≤ –∫ –≤—ã—Å–æ–∫–∏–º —Ä–∏—Å–∫–∞–º —Ä–∞–¥–∏ —Ä–æ—Å—Ç–∞ (3 –±–∞–ª–ª–∞)",
    
    "–ö–∞–∫–æ–π —É —Ç–µ–±—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –≥–æ—Ä–∏–∑–æ–Ω—Ç?\n"
    "1. 1-3 –≥–æ–¥–∞ (1 –±–∞–ª–ª)\n"
    "2. 3-7 –ª–µ—Ç (2 –±–∞–ª–ª–∞)\n"
    "3. 7+ –ª–µ—Ç (3 –±–∞–ª–ª–∞)",
    
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –≤–∞–∂–Ω–µ–µ: —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏–ª–∏ –≤—ã—Å–æ–∫–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å?\n"
    "1. –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (1 –±–∞–ª–ª)\n"
    "2. –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å—é –∏ —Ä–∏—Å–∫–æ–º (2 –±–∞–ª–ª–∞)\n"
    "3. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç (3 –±–∞–ª–ª–∞)",
    
    "–ö–∞–∫—É—é –ø—Ä–æ—Å–∞–¥–∫—É –ø–æ—Ä—Ç—Ñ–µ–ª—è —Ç—ã –≥–æ—Ç–æ–≤ —Ç–µ—Ä–ø–µ—Ç—å?\n"
    "1. –î–æ -5% (1 –±–∞–ª–ª)\n"
    "2. –î–æ -15% (2 –±–∞–ª–ª–∞)\n"
    "3. –î–æ -30% –∏ –≤—ã—à–µ (3 –±–∞–ª–ª–∞)"
]

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /risk_profile
def handle_risk_profile(update: Update, context: CallbackContext) -> None:
    """ –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—è. """
    user_id: int = update.message.chat_id
    user_responses[user_id] = {"score": 0, "question_index": 0}
    
    context.bot.send_message(
        chat_id=user_id,
        text="–î–∞–≤–∞–π –æ–ø—Ä–µ–¥–µ–ª–∏–º —Ç–≤–æ–π —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—å. –Ø –∑–∞–¥–∞–º —Ç–µ–±–µ 4 –≤–æ–ø—Ä–æ—Å–∞. –í—ã–±–∏—Ä–∞–π –Ω–æ–º–µ—Ä –æ—Ç–≤–µ—Ç–∞."
    )
    ask_next_question(user_id, context)

# –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
def ask_next_question(user_id: int, context: CallbackContext) -> None:
    """ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å –∏–∑ —Å–ø–∏—Å–∫–∞. """
    user_data = user_responses.get(user_id)
    
    if user_data and user_data["question_index"] < len(risk_questions):
        context.bot.send_message(
            chat_id=user_id,
            text=risk_questions[user_data["question_index"]]
        )
    else:
        calculate_risk_profile(user_id, context)

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã
def handle_risk_response(update: Update, context: CallbackContext) -> None:
    """ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É. """
    user_id: int = update.message.chat_id
    user_data = user_responses.get(user_id)
    
    if user_data is None or user_data["question_index"] >= len(risk_questions):
        return
    
    answer = update.message.text.strip()
    if answer in ["1", "2", "3"]:
        user_data["score"] += int(answer)
        user_data["question_index"] += 1
        ask_next_question(user_id, context)
    else:
        context.bot.send_message(chat_id=user_id, text="–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏ 1, 2 –∏–ª–∏ 3.")

# –§—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—è
def calculate_risk_profile(user_id: int, context: CallbackContext) -> None:
    """ –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–±—Ä–∞–Ω–Ω—ã—Ö –±–∞–ª–ª–æ–≤ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç. """
    user_data = user_responses.get(user_id)
    if user_data is None:
        return
    
    score = user_data["score"]
    
    if score <= 7:
        profile = "üîµ –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π"
    elif score <= 11:
        profile = "üü† –£–º–µ—Ä–µ–Ω–Ω—ã–π"
    else:
        profile = "üî¥ –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π"
    
    db.save_risk_profile(user_id, profile)
    
    context.bot.send_message(
        chat_id=user_id,
        text=f"–¢–≤–æ–π —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—å: **{profile}**. –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—à—å –ø–µ—Ä–µ–π—Ç–∏ –∫ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—é –ø–æ—Ä—Ç—Ñ–µ–ª—è!"
    )
```